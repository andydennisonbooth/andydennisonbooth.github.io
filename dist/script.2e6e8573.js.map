{"version":3,"sources":["js/script.js"],"names":["document","addEventListener","Game","render","canvas","getElementById","foreground","stepHz","cellSize","seedRatio","colorMap","dead","reviving","dying","alive","first","cells","method","bind","init","stretch","seed","updateCells","paint","x","width","y","height","Math","random","setTimeout","requestAnimationFrame","offsetWidth","offsetHeight","xCells","ceil","yCells","length","push","pop","forEach","col","newCells","newCol","cell","includes","aliveNeighbors","neighborsOf","reduce","count","Number","nextState","neighbors","i","j","mod","drawCell","color","ctx","strokeStyle","fillStyle","fillRect","getContext","n","m"],"mappings":"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","file":"script.2e6e8573.js","sourceRoot":"../src","sourcesContent":["\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    const game = new Game();\n    game.render();\n});\n\nclass Game {\n    constructor() {\n        this.canvas = document.getElementById('canvas');\n        this.foreground = document.getElementById('foreground');\n\n        this.stepHz = 10;\n        this.cellSize = 14;\n        this.seedRatio = 0.2;\n        this.colorMap = {\n            dead: '#ffffff',\n            reviving: '#fbfbfb',\n            dying: '#f7f7f7',\n            alive: '#f3f3f3'\n        };\n\n        this.first = true;\n        this.cells = [];\n\n        for (let method of ['render', 'stretch']) this[method] = this[method].bind(this);\n\n        this.init();\n    }\n\n    get ctx() {\n        return this.canvas.getContext('2d');\n    }\n\n    get width() {\n        return this.cells.length;\n    }\n\n    get height() {\n        return this.cells[0]?.length || 0;\n    }\n\n    init() {\n        this.stretch();\n        this.seed();\n        this.updateCells();\n        this.paint()\n    }\n\n    seed() {\n        for (let x = 0; x < this.width; x++) {\n            for (let y = 0; y < this.height; y++) {\n                if (Math.random() < this.seedRatio) this.cells[x][y] = 'alive';\n            }\n        }\n    }\n\n    render() {\n        this.stretch();\n        this.updateCells();\n        this.paint();\n        setTimeout(() => requestAnimationFrame(this.render), 1000 / this.stepHz);\n    }\n\n    stretch() {\n        const width = this.foreground.offsetWidth;\n        const height = this.foreground.offsetHeight;\n\n        this.canvas.width = width;\n        this.canvas.height = height;\n\n        const xCells = Math.ceil(width / this.cellSize);\n        const yCells = Math.ceil(height / this.cellSize);\n\n        while (this.cells.length < xCells) this.cells.push([]);\n        while (this.cells.length > xCells) this.cells.pop();\n\n        while ((this.cells[0]?.length || 0) < yCells) this.cells.forEach(col => col.push('dead'));\n        while ((this.cells[0]?.length || 0) > yCells) this.cells.forEach(col => col.pop());\n    }\n\n    updateCells() {\n        this.cells = this.newCells();\n    }\n\n    newCells() {\n        const newCells = [];\n        for (let x = 0; x < this.width; x++) {\n            const col = this.cells[x];\n            const newCol = [];\n\n            for (let y = 0; y < this.height; y++) {\n                const cell = col[y];\n                const alive = ['alive', 'dying'].includes(cell);\n                const neighbors = neighborsOf(this.cells, x, y);\n                const aliveNeighbors = neighbors.reduce((count, cell) => count + Number(['alive', 'dying'].includes(cell)), 0);\n\n                let nextState;\n                if (alive) {\n                    nextState = aliveNeighbors === 2 || aliveNeighbors === 3 ? 'alive' : 'dead';\n                } else {\n                    nextState = aliveNeighbors === 3 ? 'alive' : 'dead';\n                }\n\n                newCol.push(nextState);\n            }\n\n            newCells.push(newCol);\n        }\n\n        for (let x = 0; x < this.width; x++) {\n            const col = newCells[x];\n\n            for (let y = 0; y < this.height; y++) {\n                const cell = col[y];\n                const neighbors = neighborsOf(newCells, x, y);\n                const aliveNeighbors = neighbors.reduce((count, cell) => count + Number(['alive', 'dying'].includes(cell)), 0);\n\n                if (cell === 'alive' && aliveNeighbors !== 2 && aliveNeighbors !== 3) {\n                    col[y] = 'dying';\n                } else if (cell === 'dead' && aliveNeighbors === 3) {\n                    col[y] = 'reviving';\n                }\n            }\n        }\n\n        return newCells;\n    }\n\n    neighborsOf(x, y) {\n        const neighbors = [];\n        for (let i = -1; i <= 1; i++) {\n            for (let j = -1; j <= 1; j++) {\n                if (i === 0 && j === 0) continue;\n\n                neighbors.push(this.cells[mod(x + i, this.width)][mod(y + j, this.height)]);\n            }\n        }\n\n        return neighbors;\n    }\n\n    paint() {\n        for (let x = 0; x < this.width; x++) {\n            const col = this.cells[x];\n\n            for (let y = 0; y < this.height; y++) {\n                const cell = col[y];\n                this.drawCell(x, y, this.colorMap[cell]);\n            }\n        }\n    }\n\n    drawCell(x, y, color) {\n        this.ctx.strokeStyle = color;\n        this.ctx.fillStyle = color;\n        this.ctx.fillRect(x * this.cellSize, y * this.cellSize, this.cellSize, this.cellSize);\n    }\n}\n\nconst neighborsOf = (cells, x, y) => {\n    const width = cells.length;\n    const height = cells[0]?.length || 0;\n\n    const neighbors = [];\n    for (let i = -1; i <= 1; i++) {\n        for (let j = -1; j <= 1; j++) {\n            if (i === 0 && j === 0) continue;\n\n            neighbors.push(cells[mod(x + i, width)][mod(y + j, height)]);\n        }\n    }\n\n    return neighbors;\n};\n\nconst mod = (n, m) => n < 0 ? (m + n) % m : n % m;\n"]}